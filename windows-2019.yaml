---
variables:
    iso_url: https://software-download.microsoft.com/download/pr/17763.737.190906-2324.rs5_release_svc_refresh_SERVER_EVAL_x64FRE_en-us_1.iso
    iso_checksum: sha256:549bca46c055157291be6c22a3aaaed8330e78ef4382c99ee82c896426a1cee1
    memory: '8192'
    rgldir: '{{env `RGLDIR`}}'
    cpus: '4'
builders:
  - name: windows-2019-amd64-virtualbox
    type: virtualbox-iso
    iso_url: '{{user `iso_url`}}'
    iso_checksum: '{{user `iso_checksum`}}'
    memory: '{{user `memory`}}'
    guest_os_type: Windows2019_64
    shutdown_command: shutdown /s /t 0 /f /d p:4:1 /c "Packer Shutdown"
    floppy_files:
      - '{{user `rgldir`}}/windows-2019/autounattend.xml'
      - '{{user `rgldir`}}/winrm.ps1'
    communicator: winrm
    winrm_username: vagrant
    winrm_password: vagrant
    winrm_timeout: 15m
    guest_additions_mode: attach
    cpus: '{{user `cpus`}}'
    hard_drive_interface: sata
    iso_interface: sata
    vboxmanage:
      - - storagectl
        - '{{.Name}}'
        - --name
        - IDE Controller
        - --remove
      - - modifyvm
        - '{{.Name}}'
        - --graphicscontroller
        - vmsvga
      - - modifyvm
        - '{{.Name}}'
        - --vram
        - "128"
      - - modifyvm
        - '{{.Name}}'
        - --accelerate3d
        - on
